\documentclass[10pt,twoside]{article}

\newcommand{\reporttitle}{Level 1 + Level 2}
\newcommand{\reportauthora}{Ayush Bansal}
\newcommand{\reportauthorb}{Gunjan Jalori}
\newcommand{\reportauthorc}{Siddharth Nohria}
\newcommand{\reporttype}{Solution Report 1}
\newcommand{\cida}{160177}
\newcommand{\cidb}{170283}
\newcommand{\cidc}{160686}

% include files that load packages and define macros
\input{includes} % various packages needed for maths etc.
\input{notation} % short-hand notation and macros

%\setlength{\parskip}{0pt}
%\setlength{\parsep}{0pt}
%\setlength{\topskip}{0pt}
%\setlength{\topmargin}{0pt}
%\setlength{\partopsep}{0pt}
%%\setlength\lineskip{0pt}
%\linespread{0.5}
%\setlength{\textfloatsep}{2pt}
%\setlength{\intextsep}{2pt}

%\setlength\itemsep{0em}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
% front page
\input{titlepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%% Main document
\section{Chapter 1 (The Entry)}

There are 5 sub-levels in the chapter, first 4 of these don't have any cipher which needs to be decrypted. \newline

The last sub-level is a \textbf{Substitution Cipher}, the answer to - ``how it was recognised and solved" is explained in the subsection after the following list of commands. \newline

Below is the solution to each of the sub-levels:
\begin{enumerate}
  \setlength\itemsep{0em}
  \item go
  \item read
  \item enter
  \item read
  \item cyLe70Lecy
\end{enumerate}

\subsection{Substitution Cipher}

The ciphertext given was: \newline

\texttt{Nwy dejp pmcplpz cdp sxlrc adegipl ws cdp aejpr. Er nwy aem rpp cdplp xr mwcdxmv ws xmcplprc xm cdp adegipl. Rwgp ws cdp qecpl adegiplr fxqq ip gwlp xmcplprcxmv cdem cdxr wmp, x eg rplxwyr. Cdp awzp yrpz swl cdxr gprrevp xr e rxgbqp ryircxcycxwm axbdpl xm fdxad zxvxcr dejp ippm rdxscpz in 2 bqeapr. Swl cdxr lwymz berrfwlz xr vxjpm ipqwf, fxcdwyc cdp hywcpr.} \newline

For identifying what kind of cipher is applied in the above text, we will use the \textbf{Index of Coincidence}. \newline

The detailed explanation on \textit{Index of Coincidence} can be found in \cref{ic}. \newline

The \textit{Index of Coincidence} of the above ciphertext is about $0.07$, which is approximately same as a valid English text, this suggests that the cipher used is \textit{Mono-alphabetic} such as \textit{Substitution Cipher}. \newline

For Solving the \textit{Substitution Cipher}, the following steps were employed:
\begin{enumerate}
  \setlength\itemsep{0em}
    \item Calculate the frequency of each of the characters in the ciphertext, ignoring anything which is not an english alphabet.
    \item The Character with the highest frequency is most probably `e' or `a', which can be placed in its place and identified further.
    \item As the places get revealed, played hangman to find out what the other characters might be looking at one-letter, 2-letter, 3-letter words with highest number of characters revealed.
    \item Built the decryption key by keeping a map of characters as they are being replaced.
    \item Finally used the decryption key to decrypt the code given for the solution.
\end{enumerate}

The code used in this part is in the file - \texttt{break\_substitution.py}. \newline

The Steps employed in the hangman game and building the key are mentioned below:
\begin{minted}{python}
key = {}
key['p'] = 'e'    # Because 'p' has very high frequency
key['r'] = 's'    # 'r' has very high frequency,
                  #  _ee word exists, matches with "see" not "bee"
key['i'] = 'b'    # _e word exists, matches with "be"
key['n'] = 'y'    # b_ word exists, matches with "by"
key['m'] = 'n'    # bee_ word exists, matches with "been"
key['w'] = 'o'    # _ne word exists, matches with "one"
key['s'] = 'f'    # o_ word exists, 'n' is already taken, matches with "of"
key['l'] = 'r'    # fo_ word exists, matches with "for"
key['y'] = 'u'    # yo_ word exists, matches with "you"
key['g'] = 'm'    # so_e word exists, matches with "some"
key['z'] = 'd'    # use_ word exists, 'r' is already taken, matches with "used"
key['c'] = 't'    # en_ered word exists, matches with "entered"
key['d'] = 'h'    # t_e word exists, matches with "the"
key['x'] = 'i'    # f_rst word and _ (single letter word) exist,
                  # matches with "first" and "i"
key['e'] = 'a'    # single letter word exists, 'i' is already taken, matches with "a"
key['j'] = 'v'    # ha_e word exists, matches with "have"
key['a'] = 'c'    # _hamber word exists, matches with "chamber"
key['v'] = 'g'    # nothin_ word exists, matches with "nothing"
key['f'] = 'w'    # _hich word exists, matches with "which"
key['q'] = 'l'    # be_ow and wi__ word exists, matches with "below" and "will"
key['b'] = 'p'    # sim_le and ci_her word exists, matches with "simple" and "cipher"
key['h'] = 'q'    # _uotes word exists, matches with "quotes"
\end{minted}

The plaintext revealed after using the above decryption key is: \newline

\texttt{You  have  entered  the  first  chamber  of  the  caves.  As  you  can  see  there  is  nothing  of  interest  in  the  chamber.  Some  of  the  later  chambers  will  be  more  interesting  than  this  one,  i  am  serious.  The  code  used  for  this  message  is  a  simple  substitution  cipher  in  which  digits  have  been  shifted  by  2  places.  For  this  round  password  is  given  below,  without  the  quotes.}

\begin{minted}{python}
# For the case of integer digits, "1" must be subtracted from each digit, as mentioned
# text after decryption, it was "2" but it itself was shifted so
# x+x = 2, this gives x = 1
\end{minted}

So, final plaintext is: \newline

\texttt{You  have  entered  the  first  chamber  of  the  caves.  As  you  can  see  there  is  nothing  of  interest  in  the  chamber.  Some  of  the  later  chambers  will  be  more  interesting  than  this  one,  i  am  serious.  The  code  used  for  this  message  is  a  simple  substitution  cipher  in  which  digits  have  been  shifted  by  1  places.  For  this  round  password  is  given  below,  without  the  quotes.} \newline

Using the above decryption key and the logic for digit, we can decipher the code for the answer as well: \newline

Code: \texttt{anQp81Qpan} \newline
Solution: \texttt{cyLe70Lecy}

\section{Chapter 2 (The Caveman)}
There are 2 sub-levels in the chapter, first one doesn't have any cipher which needs to be decrypted. \newline

The second sub-level is a \textbf{Vigenere Cipher}, the answer to - ``how it was recognised and solved" is explained in the subsection after the following list of commands. \newline

The detailed explanation on \textit{Vigenere Cipher} can be found in \cref{vc}. \newline

Below is the solution to each of the sub-levels:
\begin{enumerate}
  \setlength\itemsep{0em}
    \item read
    \item the\_cave\_man\_be\_pleased
\end{enumerate}

\subsection{Vigenere Cipher}
The ciphertext given was: \newline

\texttt{Lg ccud qh urg tgay ejbwdkt, wmgtf su bgud nkudnk lrd vjfbg. Yrhfm qvd vng sfuuxytj \newline "vkj\_ecwo\_ogp\_ej\_rnfkukf" wt iq urtuwjm. Ocz iqa jdag vio uzthsivi pqx vkj pgyd encpggt. Uy hopg yjg fhkz arz hkscv ckoq pgfn vu wwygt nkioe zttft djkth.} \newline

For identifying what kind of cipher is applied in the above text, we will use the \textbf{Index of Coincidence}. \newline

The detailed explanation on \textit{Index of Coincidence} can be found in \cref{ic}. \newline

The \textit{Index of Coincidence} of the above ciphertext is about $0.042$, which is closer to the uniform distribution of English text, this suggests that the cipher is \textit{Poly-alphabetic} such as \textit{Vigenere Cipher}, it may be some other Poly-alphabetic cipher as well but we still have to give it a shot. \newline

For solving the \textit{Vigenere Cipher}, the following steps were employed:
\begin{enumerate}
  \setlength\itemsep{0em}
    \item Remove all characters from the text which are not part of the English alphabets and capitilize all characters.
    \item Partition the text according to different key lengths and sort them according to the \textit{Index of Coincidences} achieved, since higher the IC, closer it is to valid English Text.
    \item For each keylen, perform frequency analysis to get the best key possible with the given length.
    \item Try out all the keys retrieved and see which one gives some valid English text.
\end{enumerate}

The code used in this part is in the file - \texttt{break\_vigenere.py}. \newline

The plaintext revealed after using the above decryption key is: \newline

\texttt{Be wary of the next chamber, there is very little joy there. Speak out the password \newline"the\_cave\_man\_be\_pleased" to go through. May you have the strength for the next chamber. To find the exit you first will need to utter magic words there.} \newline

From the above, the solution is revealed: \texttt{the\_cave\_man\_be\_pleased}.
\newpage
\section{Appendix}

This section explains each of the things used in between the solutions without proper explanation.

\subsection{Index of Coincidence} \label{ic}

The \textbf{Index of Coincidence} is a measure of how similar a frequency distribution is to the uniform distribution.
$$ I.C. = \frac{\sum_{i=A}^{i=Z} f_i(f_i-1)}{N(N-1)}$$

where $f_i$ is the count of letter $i$ (where $i = A,B,...,Z$) in the ciphertext, and $N$ is the total number of letters in the ciphertext. \newline

Important facts about the \textit{Index of Coincidence}:
\begin{itemize}
  \setlength\itemsep{0em}
    \item The \textit{Index of Coincidence} of valid English text is about $0.07$.
    \item The \textit{Index of Coincidence} for uniform distribution of English text is about $0.038$.
    \item The \textit{Index of Coincidence} remains the same for the ciphertext and plaintext if cipher is \textbf{Mono-alphabetic} (i.e. Substitution Cipher).
    \item The \textit{Index of Coincidence} of ciphertext is closer to uniform distribution if cipher is \textbf{Poly-alphabetic} (such as Vigenere Cipher).
\end{itemize}

We can get an approximate idea of what kind of cipher is used to generate the ciphertext by using the \textit{Index of Coincidence}.

\subsection{Vigenere Cipher} \label{vc}
The Vigenere Cipher is a polyalphabetic substitution cipher. \newline

Suppose, the length of the encryption key is $k$, then the string formed by picking out each letter with a multiple of $k$ letters in between them will be a \textit{Caesar Cipher}. \newline

Since each such string is a \textit{Caesar Cipher}, the \textit{Index of Coincidence} of this string will be closer to that of valid English text rather than closer to uniform distribution. \newline

Using the above principle, we can crack the \textit{Vigenere Cipher}.

\end{document}
